# Silent-NAS 项目规划（PLAN）

## 项目总体目标和愿景
- 构建面向个人 / 家庭 / 小团队的分布式 NAS 系统。
- 提供统一的文件存储、索引搜索、多节点同步与多协议访问能力（WebDAV / S3 / HTTP）。
- 在保持简单易用的前提下，逐步演进为高可靠、高性能的个人云存储基础设施。

## 版本里程碑规划

- **v0.7.x（当前阶段）**
  - V2 存储架构重构（基于 silent-storage，Sled 元数据，CDC + 去重 + 压缩）。
  - WebDAV 协议与桌面客户端兼容性优化。
  - 大文件上传与索引性能优化。

- **v0.8.x（规划中）**
  - 多节点同步增强（冲突解决策略、拓扑优化）。
  - 更完善的权限与认证体系。
  - 面向 UI / 前端的高层 API 优化。

## 功能优先级（当前关注）

1. 存储 V2 架构稳定性与性能（已在 TODO 中细化）。
2. WebDAV / S3 等外部协议在大文件场景下的体验优化。
3. 检索与审计（索引、事件流）的可观测性与调试能力。

当前任务重点：
- **WebDAV 大文件流式上传**
  - 避免 HTTP 层一次性将整个请求体读入内存。
  - 保持与现有 silent-storage 去重 / 压缩 / 版本链逻辑兼容。
  - 为后续实现续传 / 秒传铺路（需要额外协议设计）。

## 技术选型与架构说明（与本任务相关）

- 存储引擎：`silent-storage`（增量存储 + 去重 + 压缩，基于 Sled 元数据）。
- Web 服务框架：`silent`。
- WebDAV 实现：`src/webdav`（基于 StorageManagerTrait + WebDavHandler）。
- ID 方案：全部使用 `scru128` 生成全局唯一 ID。

## 关键时间节点（与流式上传相关）

- 2025-11-18：发现大文件（>2GB）上传一次性读入内存导致异步处理占用较多资源的问题。
- 2025-11-18：规划并开始实现 WebDAV PUT 大文件流式上传（HTTP 层流式 + 后台异步持久化）。
