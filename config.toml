# Silent-NAS 配置文件
# 详细配置说明请参考 config.example.toml

# ==================== 服务器配置 ====================
[server]
# 监听地址（0.0.0.0 表示所有网卡，127.0.0.1 表示仅本地）
host = "127.0.0.1"

# HTTP API 服务端口（REST API、文件上传下载）
http_port = 8080

# gRPC 服务端口（高性能 RPC 调用）
grpc_port = 50051

# QUIC 传输服务端口（基于 UDP 的高速文件传输）
quic_port = 4433

# WebDAV 服务端口（兼容 WebDAV 客户端）
webdav_port = 8081

# S3 兼容 API 服务端口（兼容 AWS S3 协议）
s3_port = 9000

# ==================== 存储配置 ====================
[storage]
# 文件存储根目录（相对路径或绝对路径）
root_path = "./storage"

# 文件分块大小（字节）
# 4MB = 4194304, 8MB = 8388608, 16MB = 16777216
chunk_size = 4194304
# 是否启用压缩
# true: 启用压缩，节省存储空间
# false: 禁用压缩，提高读写性能
enable_compression = true

# 压缩算法
# 可选值: "lz4" 或 "zstd"
# - lz4:  速度快，压缩率中等（推荐）
# - zstd: 压缩率高，速度稍慢
compression_algorithm = "lz4"

# 是否启用去重
# true: 启用块级去重，大幅节省存储空间
# false: 禁用去重，提高写入性能
enable_deduplication = true

# 是否启用自动垃圾回收（GC）
# true: 自动清理未引用的数据块
# false: 需要手动触发GC
enable_auto_gc = true

# GC触发间隔（秒）
# 定期清理被删除文件占用的存储块
#
# 推荐值:
# - 3600   = 1小时（默认值，适合大多数场景）
# - 1800   = 30分钟（存储空间紧张时）
# - 7200   = 2小时（存储空间充足时）
# - 86400  = 24小时（低优先级场景）
#
# 注意: 间隔过短会增加系统负载，过长会延迟释放存储空间
gc_interval_secs = 3600

# ==================== NATS 消息队列配置 ====================
# 用于多节点文件同步，单节点模式可不配置或配置错误的地址
[nats]
# NATS 服务器地址
# 单节点：留空或配置不存在的地址（如 nats://localhost:4222）
# 多节点：配置实际的 NATS 服务器地址
url = "nats://127.0.0.1:4222"

# 事件主题前缀（用于区分不同的 NAS 集群）
topic_prefix = "silent.nas.files"

# ==================== S3 配置 ====================
[s3]
# S3 访问密钥（Access Key）
access_key = "minioadmin"

# S3 密钥（Secret Key）
secret_key = "minioadmin"

# 是否启用 S3 认证（false 表示允许匿名访问）
enable_auth = false

# ==================== 认证配置 ====================
[auth]
# 是否启用用户认证系统（false 表示无需认证，任何人都可访问）
enable = false

# 用户数据库路径（使用 Sled 嵌入式数据库）
db_path = "./data/auth.db"

# JWT 签名密钥（生产环境必须修改为强随机字符串！）
# 可使用命令生成：openssl rand -base64 32
jwt_secret = "silent-nas-secret-key-change-in-production"

# 访问令牌过期时间（秒）默认 3600 秒（1小时）
access_token_exp = 3600

# 刷新令牌过期时间（秒）默认 604800 秒（7天）
refresh_token_exp = 604800
