# Silent-NAS 配置文件
# 详细配置说明请参考 config.example.toml

# ==================== 服务器配置 ====================
[server]
# 监听地址（0.0.0.0 表示所有网卡，127.0.0.1 表示仅本地）
host = "127.0.0.1"

# HTTP API 服务端口（REST API、文件上传下载）
http_port = 8080

# gRPC 服务端口（高性能 RPC 调用）
grpc_port = 50051

# QUIC 传输服务端口（基于 UDP 的高速文件传输）
quic_port = 4433

# WebDAV 服务端口（兼容 WebDAV 客户端）
webdav_port = 8081

# S3 兼容 API 服务端口（兼容 AWS S3 协议）
s3_port = 9000

# ==================== 存储配置 ====================
[storage]
# 文件存储根目录（相对路径或绝对路径）
root_path = "./storage"

# 文件分块大小（字节）
# 4MB = 4194304, 8MB = 8388608, 16MB = 16777216
chunk_size = 4194304

# 存储引擎版本（默认: "v1"）
# "v1": 简单可靠的文件存储（推荐用于生产环境）
# "v2": 暂不支持通过配置文件启用
#
# ⚠️  重要说明：
# V2 存储引擎的完整功能（增量存储、块级去重、自动压缩）
# 目前无法通过配置文件启用，原因是需要重构整个代码库的类型系统。
#
# 如需测试 V2 完整功能，请：
# 1. 运行集成测试：cargo test --test storage_v2_integration_test
# 2. 使用 API：通过 create_storage_v2() 函数创建实例
#
# 详细说明请参考 config.example.toml 和 tests/storage_v2_integration_test.rs
version = "v1"

# ==================== NATS 消息队列配置 ====================
# 用于多节点文件同步，单节点模式可不配置或配置错误的地址
[nats]
# NATS 服务器地址
# 单节点：留空或配置不存在的地址（如 nats://localhost:4222）
# 多节点：配置实际的 NATS 服务器地址
url = "nats://127.0.0.1:4222"

# 事件主题前缀（用于区分不同的 NAS 集群）
topic_prefix = "silent.nas.files"

# ==================== S3 配置 ====================
[s3]
# S3 访问密钥（Access Key）
access_key = "minioadmin"

# S3 密钥（Secret Key）
secret_key = "minioadmin"

# 是否启用 S3 认证（false 表示允许匿名访问）
enable_auth = false

# ==================== 认证配置 ====================
[auth]
# 是否启用用户认证系统（false 表示无需认证，任何人都可访问）
enable = false

# 用户数据库路径（使用 Sled 嵌入式数据库）
db_path = "./data/auth.db"

# JWT 签名密钥（生产环境必须修改为强随机字符串！）
# 可使用命令生成：openssl rand -base64 32
jwt_secret = "silent-nas-secret-key-change-in-production"

# 访问令牌过期时间（秒）默认 3600 秒（1小时）
access_token_exp = 3600

# 刷新令牌过期时间（秒）默认 604800 秒（7天）
refresh_token_exp = 604800
